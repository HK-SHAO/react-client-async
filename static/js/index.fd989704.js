(()=>{"use strict";var e={1219:function(e,n,t){var r=t(5893),s=t(7294),l=t(745),c=t(5710),a=t(9442),i=t(4354),o=t(5046),u=t(9166);a.Z.registerLanguage("tsx",o.Z),a.Z.registerLanguage("bash",i.Z);let d=/language-(\w+)/,h={display:"contents"};Object.freeze({});let x=(async()=>{}).constructor,m=Symbol("Siganl for Async Function Component");function f(e){let n,t,{$fc:l,$waiting:c,$fallback:a,...i}=e;if(l instanceof x&&(n=l),(null==l?void 0:l.$$typeof)===Symbol.for("react.memo")&&(n=l.type,t=l.compare),!n)return(0,r.jsx)(l,{...i});let{state:o}=y((0,s.useCallback)((e,t)=>{let{signal:r}=t;return n({...e,[m]:r})},[n]),i,{autoLoad:!0,sampeArgs:t}),{pending:u,result:d,error:h}=o;if(u)return"function"!=typeof c?c:(0,r.jsx)(f,{$fc:c});if(h&&a)return"function"!=typeof a?a:(0,r.jsx)(f,{$fc:a,$waiting:c,$fallback:a,error:h});if(h)throw h;return d}let p=(e,n)=>{if(e===n)return!0;if("object"!=typeof e||"object"!=typeof n||null===e||null===n)return!1;let t=Object.keys(e),r=Object.keys(n);if(t.length!==r.length)return!1;for(let r of t)if(e[r]!==n[r])return!1;return!0},j=Symbol("Aborted By Rerender"),b=Symbol("Aborted By User");function y(e,n){var t,r;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l.autoLoad??(l.autoLoad=!0),l.sampeArgs??(l.sampeArgs=p);let[c,a]=(0,s.useState)(),[i,o]=(0,s.useState)(),[u,d]=(0,s.useState)(),h=(0,s.useRef)(null),x=(0,s.useRef)(e),m=(0,s.useRef)(n),f=(0,s.useRef)(null),[y,g]=(0,s.useState)(0),v=(0,s.useRef)(y),k=(0,s.useCallback)(e=>(null==e||e.addEventListener("abort",()=>{let n=h.current;null==n||n.abort(e.reason)}),g(e=>(e+1)%3),f.current=Promise.withResolvers(),f.current.promise),[]),N=(0,s.useCallback)(()=>{let e=h.current;null==e||e.abort(b)},[]),w=x.current===e,A=null===(t=l.sampeArgs)||void 0===t?void 0:t.call(l,m.current,n),C=v.current===y,O=void 0!==c||!l.autoLoad,R={state:{pending:c,result:i,error:u},load:k,stop:N};if(w&&A&&C&&O)return R;x.current=e,m.current=n,v.current=y,a(!0);let S=new AbortController,$=S.signal,E=Promise.resolve(e(n,{signal:$}));null===(r=h.current)||void 0===r||r.abort(j),h.current=S;let _=f.current;return E.then(e=>{d(void 0),o(()=>e),null==_||_.resolve(e)}).catch(e=>{d(()=>e),null==_||_.reject(e)}).finally(()=>{var e;(null===(e=h.current)||void 0===e?void 0:e.signal)===$&&a(!1)}),R}function g(e,n){let{promise:t,resolve:r,reject:s}=Promise.withResolvers(),l=setTimeout(r,e);return n.addEventListener("abort",()=>{clearTimeout(l),s(n.reason)}),t}let v=(0,s.memo)(async e=>{let{count:n,addCount:t,[m]:s}=e;if(await g(1e3,s),.5>Math.random())throw Error("Random Error");return(0,r.jsxs)("button",{type:"button",className:"flex justify-center items-center ml-2 btn btn-blue",onClick:t,children:["Async Component",(0,r.jsx)("span",{className:"inline bg-black/30 ml-2 px-4 py-0.5 rounded-full text-sm",children:n})]})});function k(){let[e,n]=(0,s.useState)(0),t=(0,s.useCallback)(()=>{n(e=>e+1)},[]),l=(0,s.useCallback)(n=>{let{error:s}=n;return(0,r.jsxs)("button",{type:"button",className:"flex justify-center items-center ml-2 btn btn-red",onClick:t,children:[s instanceof Error?s.message:"Unknown Error",(0,r.jsx)("span",{className:"inline bg-black/30 ml-2 px-4 py-0.5 rounded-full text-sm",children:e})]})},[e,t]),c=(0,s.useMemo)(()=>(0,r.jsxs)("button",{type:"button",className:"flex justify-center items-center ml-2 btn btn-gray",onClick:t,children:["Loading...",(0,r.jsx)("span",{className:"inline bg-black/30 ml-2 px-4 py-0.5 rounded-full text-sm",children:e})]}),[e,t]);return(0,r.jsx)("div",{className:"flex flex-col items-center gap-2",children:(0,r.jsx)(f,{$fc:v,$waiting:c,$fallback:l,count:e,addCount:t})})}let N=(0,s.memo)(async e=>{let{[m]:n,n:t,seed:s}=e;return t<=0?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{children:"0"})}):(0,r.jsxs)(r.Fragment,{children:[await g(99,n),(0,r.jsx)("div",{children:t}),(0,r.jsx)(f,{$fc:N,n:t-1,seed:s}),(0,r.jsx)("div",{children:t})]})});function w(){let[e,n]=(0,s.useState)(0),t=(0,s.useCallback)(()=>n(e=>e+1),[]);return(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center gap-4",children:[(0,r.jsx)("div",{className:"w-[42em] text-xs [&>.grid]:place-items-center font-bold",children:(0,r.jsx)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(2em,1fr))] min-h-28",children:(0,r.jsx)(f,{$fc:N,n:52,seed:e})})}),(0,r.jsxs)("button",{type:"button",className:"flex justify-center items-center btn btn-blue",onClick:t,children:["\uD83D\uDC46 Reload",(0,r.jsx)("span",{className:"inline bg-black/30 ml-2 px-4 py-0.5 rounded-full text-sm",children:e})]})]})}var A=t(7570);let C={...A.iU,BASE_BACKGROUND_COLOR:"transparent",BASE_FONT_SIZE:"var(--text-sm)",ARROW_FONT_SIZE:"var(--text-sm)",TREENODE_FONT_SIZE:"var(--text-sm)"},O=async(e,n)=>{let{cntRef:t}=e,{signal:r}=n;return await g(1e3,r),`${t.current++} times`};function R(){let e=y(O,{cntRef:(0,s.useRef)(0)}),n=(0,s.useCallback)(async()=>{try{let n=await e.load();c.Am.success(`Result: ${n}`)}catch(e){c.Am.error(`${String(e)}`)}},[e.load]),t=(0,s.useCallback)(()=>e.stop(),[e.stop]);return(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 bg-gray-200 py-4 p-2 rounded-lg",children:[(0,r.jsx)(A.vu,{data:e,expandLevel:3,theme:C}),(0,r.jsx)("div",{className:"bg-gray-500/10 m-2 py-[0.5px] w-full"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{type:"button",className:"btn btn-blue",onClick:n,children:"Load"}),(0,r.jsx)("button",{type:"button",className:"btn btn-red",onClick:t,children:"Stop"})]})]})}let S="React Async for Client";function $(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"box-content absolute flex bg-clip-text bg-gradient-to-r from-blue-500 via-teal-500 to-pink-500 blur-xl mx-auto py-4 border w-fit font-extrabold text-5xl text-center text-transparent pointer-events-none select-none",children:S}),(0,r.jsx)("span",{className:"relative top-0 flex justify-center items-center bg-clip-text bg-gradient-to-r from-blue-500 via-teal-500 to-pink-500 py-4 w-fit h-auto font-extrabold text-5xl text-center text-transparent select-auto",children:(0,r.jsx)("span",{className:"select-text",children:S})})]})}function E(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-full text-center text-5xl mt-10",children:"⚛️⏳"}),"\n",(0,r.jsx)(n.h1,{children:(0,r.jsx)($,{})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Demo:"})," ",(0,r.jsx)(n.a,{href:"https://shao.fun/react-client-async/",children:"shao.fun/react-client-async"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Repo:"})," ",(0,r.jsx)(n.a,{href:"https://github.com/HK-SHAO/react-client-async",children:"github.com/hk-shao/react-client-async"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Previously, ",(0,r.jsx)(n.code,{children:"async component"})," were only supported on the server (Next.js).\r\nWith this package, you can now easily use it on the client side as well."]}),"\n",(0,r.jsxs)("div",{className:"bg-gray-100 rounded-lg [&>h2]:mt-0 p-8",children:[(0,r.jsx)(n.h2,{children:"Install"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm i react-client-async\n"})})]}),"\n",(0,r.jsxs)("div",{className:"bg-gray-100 rounded-lg mt-6 [&>h2]:mt-0 p-8",children:[(0,r.jsxs)(n.h2,{children:[(0,r.jsx)(n.code,{children:"useAsync"})," Hook"]}),(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.code,{children:"useAsync"})," hook to create a task."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"console.log(useAsync(fn, args, options));\n"})}),(0,r.jsx)(R,{})]}),"\n",(0,r.jsxs)("div",{className:"bg-gray-100 p-8 rounded-lg mt-6 [&>h2]:mt-0",children:[(0,r.jsxs)(n.h2,{children:[(0,r.jsx)(n.code,{children:"Async"})," Component"]}),(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.code,{children:"Async"})," to render an async component."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"<Async\r\n  $fc={fc} // may be an async function component\r\n  $waiting={waiting} // waiting component\r\n  $fallback={fallback} // fallback component\r\n  {...props} // props for the function component\r\n/>\n"})}),(0,r.jsx)(k,{})]}),"\n",(0,r.jsxs)("div",{className:"bg-gray-100 p-8 rounded-lg mt-6 [&>h2]:mt-0",children:[(0,r.jsxs)(n.h2,{children:[(0,r.jsx)(n.code,{children:"Demo"})," of Recursive Async Component"]}),(0,r.jsxs)(n.p,{children:["A component can be used with ",(0,r.jsx)(n.code,{children:"memo"})," and ",(0,r.jsx)(n.code,{children:"async"})," together!"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"const Rec: AsyncFC<{ n: number; }> = memo(\r\n  async ({ [$signal]: signal, n }) =>\r\n    n <= 0 ? (\r\n      <> {/* break the recursion */}\r\n        <div>0</div>\r\n      </>\r\n    ) : (\r\n      <> {/* delay and recursion */}\r\n        {await delayWithSignal(99, signal)}\r\n        {n}<Async $fc={Rec} n={n - 1} />{n}\r\n      </>\r\n    ),\r\n);\n"})}),(0,r.jsx)(w,{})]}),"\n",(0,r.jsxs)("div",{className:"bg-gray-100 p-8 rounded-lg mt-6 [&>h2]:mt-0 pb-2 mb-10",children:[(0,r.jsx)(n.h2,{children:"What is Next?"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["⏳ ",(0,r.jsx)(n.code,{children:"useAsyncIterable"})," hook"]}),"\n",(0,r.jsxs)(n.li,{children:["⏳ ",(0,r.jsx)(n.code,{children:"Iterable async"})," component"]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"async function* IterableComponent() {\r\n  yield* OtherIterableComponent();\r\n  yield  await component1();\r\n  yield  await component2();\r\n  yield  <div>...</div>;\r\n}\n"})}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"⭐️ Star this repo if you like it! ❤❤❤"}),"\n",(0,r.jsxs)(n.li,{children:["\uD83D\uDC49 ",(0,r.jsx)(n.a,{href:"https://github.com/HK-SHAO/react-client-async",children:"github.com/hk-shao/react-client-async"})]}),"\n"]}),(0,r.jsx)(n.p,{children:"Looking forward to your feedback or contribution! \uD83D\uDE80\uD83D\uDE80\uD83D\uDE80"})]})]})}function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=e.components||{};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(E,{...e})}):E(e)}let L={code:function(e){let{className:n,children:t,...s}=e,l=n?d.exec(n):null;return l?(0,r.jsx)(a.Z,{language:l[1],customStyle:h,style:u.Z,...s,children:t}):(0,r.jsx)("code",{className:n,...s,children:t})}};function F(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"flex justify-center items-center",children:(0,r.jsx)("div",{className:"p-4 prose",children:(0,r.jsx)(_,{components:L})})})})}let I=document.getElementById("root");I&&l.createRoot(I).render((0,r.jsx)(s.StrictMode,{children:(0,r.jsx)(()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Ix,{}),(0,r.jsx)(F,{})]}),{})}))}},n={};function t(r){var s=n[r];if(void 0!==s)return s.exports;var l=n[r]={exports:{}};return e[r](l,l.exports,t),l.exports}t.m=e,t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},t.d=function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},(()=>{var e=[];t.O=function(n,r,s,l){if(r){l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[r,s,l];return}for(var a=1/0,c=0;c<e.length;c++){for(var r=e[c][0],s=e[c][1],l=e[c][2],i=!0,o=0;o<r.length;o++)(!1&l||a>=l)&&Object.keys(t.O).every(function(e){return t.O[e](r[o])})?r.splice(o--,1):(i=!1,l<a&&(a=l));if(i){e.splice(c--,1);var u=s();void 0!==u&&(n=u)}}return n}})(),t.rv=function(){return"1.2.2"},(()=>{var e={980:0};t.O.j=function(n){return 0===e[n]};var n=function(n,r){var s,l,c=r[0],a=r[1],i=r[2],o=0;if(c.some(function(n){return 0!==e[n]})){for(s in a)t.o(a,s)&&(t.m[s]=a[s]);if(i)var u=i(t)}for(n&&n(r);o<c.length;o++)l=c[o],t.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return t.O(u)},r=self.webpackChunkreact_client_async=self.webpackChunkreact_client_async||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))})(),t.ruid="bundler=rspack@1.2.2";var r=t.O(void 0,["361","471"],function(){return t(1219)});r=t.O(r)})();